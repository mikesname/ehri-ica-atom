<!--
	EAD 2002 XML SCHEMA

	This file is part of the Qubit Toolkit.
	Copyright (C) 2006-2008 Peter Van Garderen <peter@artefactual.com>
-->

<!DOCTYPE ead PUBLIC "+//ISBN 1-931666-00-8//DTD ead.dtd (Encoded Archival Description (EAD) Version 2002)//EN" "http://xml.coverpages.org/EADv20-dtd.txt">

<ead relatedencoding="MARC21">
	<eadheader langencoding="iso639-2" audience="internal" countryencoding="iso3166-1" dateencoding="iso8601" repositoryencoding="iso15511" scriptencoding="iso15924">
		<!-- required -->
        <eadid countrycode="" mainagencycode="" encodinganalog="850"><?php echo htmlentities($this->baseObject->getIdentifier() ? $this->baseObject->getIdentifier() : $this->baseObject->getLabel()) ?></eadid>
        <filedesc>
            <titlestmt>
                <titleproper><?php echo htmlentities($this->baseObject->getTitle()) ?></titleproper><!-- required -->
                <subtitle><?php echo htmlentities($this->baseObject->getAlternateTitle()) ?></subtitle>

				<?php foreach($this->baseObject->getCreators() as $creator): ?>
					<author><?php echo htmlentities($creator->getAuthorizedFormOfName()) ?></author>
				<?php endforeach; ?>
            </titlestmt>
            <editionstmt>
                <edition></edition>
            </editionstmt>
            <publicationstmt>
                <publisher><?php echo htmlentities($this->baseObject->getInstitutionResponsibleIdentifier()) ?></publisher>
				<date/>
				<address>
					<addressline/>
				</address>
            </publicationstmt>
            <seriesstmt>
                <titleproper></titleproper>
            </seriesstmt>
            <notestmt>
                <note>
                    <address>
                        <addressline></addressline>
                    </address>
                </note>
            </notestmt>
        </filedesc>
        <profiledesc>
			<creation>
				<date/>
			</creation>
			<langusage>
				<?php foreach($this->baseObject->getProperties('language_of_information_object_description') as $languageCode): ?>
					<language langcode="<?php echo $languageCode->getValue() ?>"><?php echo htmlentities(format_language($languageCode->getValue())) ?></language>
				<?php endforeach; ?>			
			</langusage>
            <descrules><?php echo htmlentities($this->baseObject->getRules()) ?></descrules>
        </profiledesc>
        <revisiondesc>
        	<change>
        		<date/>
        		<item/>
        	</change>
            <list>
                <head></head>
                <item></item>
            </list>
        </revisiondesc>
    </eadheader>
    <frontmatter>
        <titlepage>
	        <titleproper/>
            <address>
                <addressline></addressline>
            </address>
        </titlepage>
        <div>
            <head></head>
            <address>
                <addressline></addressline>
            </address>
        </div>
    </frontmatter>
    <archdesc level="<?php echo htmlentities($this->baseObject->getLevelOfDescription()) ?>" type=""><!-- required -->
        <runner></runner>
        <did>
            <head></head>
            <abstract></abstract><!-- this is common, we need a mapping -->
			<repository encodinganalog="852$a">
				<corpname encodinganalog="110"><?php echo htmlentities($this->baseObject->getRepository()) ?></corpname>
				<address>
					<addressline/>
				</address>
			</repository>
			<origination>
				<?php foreach($this->baseObject->getCreators() as $creator): ?>
					<name encodinganalog="100"><?php echo htmlentities($creator->getAuthorizedFormOfName()) ?></name>
				<?php endforeach; ?>
			</origination>
			<unittitle encodinganalog="245$a"><?php echo htmlentities($this->baseObject->getTitle()) ?></unittitle>
			<unitid encodinganalog="099" repositorycode="" countrycode=""><?php echo htmlentities($this->baseObject->getIdentifier()) ?></unitid>
			<!-- unitdate is probably dates of creation from creators; EAD1 allows multiple -->
			<unitdate type="inclusive" encodinganalog="245$f" normal=""><?php echo htmlentities($this->baseObject->getCreatedAt()) ?></unitdate>
			<physdesc encodinganalog="300$a">
				<extent><?php echo htmlentities($this->baseObject->getExtentAndMedium()) ?></extent>
				<phystech/>
			</physdesc>
			<langmaterial encodinganalog="546$a">
				<?php foreach($this->baseObject->getProperties('language_of_information_object_description') as $languageCode): ?>
					<language langcode="<?php echo $languageCode->getValue() ?>"><?php echo htmlentities(format_language($languageCode->getValue())) ?></language>
				<?php endforeach; ?>			
			</langmaterial>
			<materialspec/>
			<?php foreach($this->baseObject->getNotes() as $note): ?>
				<note><?php echo htmlentities($note->getContent) ?></note>
			<?php endforeach; ?>
        </did>
		<accessrestrict encodinganalog="506">
		    <head></head>
			<p><?php echo htmlentities($this->baseObject->getAccessConditions()) ?></p>
		</accessrestrict>
		<appraisal encodinganalog="583">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getAppraisal()) ?></p>
		</appraisal>
		<accruals encodinganalog="584">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getAccruals()) ?></p>
		</accruals>
		<acqinfo encodinganalog="541">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getAcquisition()) ?></p>
		</acqinfo>
		<arrangement encodinganalog="351">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getArrangement()) ?></p>
		</arrangement>
		<bioghist encodinganalog="545">
			<head/>
			<?php foreach($this->baseObject->getCreators() as $creator): ?>
				<p><?php echo htmlentities($creator->getHistory()) ?></p>
			<?php endforeach; ?>
		</bioghist>
		<custodhist encodinganalog="561">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getArchivalHistory()) ?></p>
		</custodhist>
		<otherfindaid encodinganalog="555">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getFindingAids()) ?></p>
		</otherfindaid>
		<prefercite encodinganalog="524">
			<head/>
			<p/>
		</prefercite>
		<processinfo encodinganalog="583">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getRevisionHistory()) ?></p>
		</processinfo>
		<relatedmaterial encodinganalog="544 1">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getRelatedUnitsOfDescription()) ?></p>
		</relatedmaterial>
		<scopecontent encodinganalog="520">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getScopeAndContent()) ?></p>
		</scopecontent>
		<separatedmaterial encodinganalog="544 0">
			<head/>
			<p/>
		</separatedmaterial>
		<userestrict encodinganalog="540">
			<head/>
			<p><?php echo htmlentities($this->baseObject->getReproductionConditions()) ?></p>
		</userestrict>
		<controlaccess>
			<persname/><!-- multiple -->
			<corpname/><!-- multiple -->
			<genreform/><!-- multiple -->
			<subject/><!-- multiple -->
		</controlaccess>		
		<dsc type="combined">
			<?php foreach($this->baseObject->getDescendants() as $descendant): ?>
				<!--  recursion is a slippery fish -->
				<c level="<?php echo htmlentities($descendant->getLevelOfDescription()) ?>">
					<did>
						<unittitle><?php echo htmlentities($descendant->getTitle()) ?></unittitle>
						<unitid><?php echo htmlentities($descendant->getIdentifier()) ?></unitid>
						<unitdate><?php echo htmlentities($descendant->getCreatedAt()) ?></unitdate>
						<physdec/>
						<daogrp/>
						<daoloc/>
						<!-- ... -->
					</did>
					<!-- c02 ... -->
				</c>
			<?php endforeach; ?>
		</dsc>
    </archdesc>
</ead>